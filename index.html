<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Family Cheese - Натуральні сири</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Вбудовані стилі CSS з усіх файлів (variables.css, themes.css, base.css, components.css, style.css) -->
    <style>
        /* === ЗМІННІ (variables.css) === */
        :root {
            /* Warm, artisanal color palette inspired by the brand image */
            --primary-color: #D4935A;
            --primary-hover: #C17A3A;
            --secondary-color: #E8B17A;
            --accent-color: #F2C98A;
            --warm-orange: #E67E22;
            --soft-peach: #F5DEB3;
            --error-color: #E74C3C;
            --warning-color: #F39C12;
            --success-color: #27AE60;
        
            --bg-primary: #FFF9F4;
            --bg-secondary: #F8F3ED;
            --bg-tertiary: #F0E6D6;
            --bg-card: #FFFFFF;
            --text-primary: #8B4513;
            --text-secondary: #A0522D;
            --text-muted: #CD853F;
            --border-color: #E6D5C7;
        
            /* Organic shadows and effects */
            --shadow-soft: 0 4px 20px rgba(212, 147, 90, 0.15);
            --shadow-medium: 0 8px 30px rgba(212, 147, 90, 0.2);
            --shadow-strong: 0 15px 40px rgba(212, 147, 90, 0.25);
        
            /* Warm gradients */
            --gradient-primary: linear-gradient(135deg, #F2C98A 0%, #D4935A 50%, #C17A3A 100%);
            --gradient-secondary: radial-gradient(circle at center, #F5DEB3 0%, #E8B17A 100%);
            --gradient-warm: linear-gradient(45deg, #FFE4B5 0%, #DEB887 50%, #D2B48C 100%);
            --gradient-overlay: linear-gradient(135deg, rgba(212, 147, 90, 0.1) 0%, rgba(245, 222, 179, 0.1) 100%);
        
            --blur-soft: blur(8px);
            --blur-medium: blur(16px);
        
            --transition-smooth: 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --transition-bounce: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        
            --border-radius-soft: 20px;
            --border-radius-medium: 16px;
            --border-radius-large: 24px;
        }

        /* === ТЕМИ (themes.css) === */
        [data-theme="dark"] {
            --bg-primary: #2C1810;
            --bg-secondary: #3D2318;
            --bg-tertiary: #4A2A1C;
            --bg-card: #3D2318;
            --text-primary: #F5DEB3;
            --text-secondary: #E8B17A;
            --text-muted: #D4935A;
            --border-color: #5D3A24;
        }

        [data-theme="dark"] .header {
            background: rgba(44, 24, 16, 0.95);
        }

        [data-theme="dark"] .review-card {
            background: var(--bg-tertiary);
        }

        /* === БАЗОВІ СТИЛІ (base.css) === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: clamp(14px, 1.5vw, 18px);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color var(--transition-smooth), color var(--transition-smooth);
            position: relative;
        }

        /* Organic background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(245, 222, 179, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(232, 177, 122, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(212, 147, 90, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .hidden {
            display: none !important;
        }

        /* === КОМПОНЕНТИ І СТИЛІ (components.css, style.css) === */
        
        /* HEADER */
        .header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(255, 249, 244, 0.95);
            backdrop-filter: var(--blur-soft);
            border-bottom: 2px solid var(--border-color);
            padding: 1.2rem 0;
            transition: all var(--transition-smooth);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .search-container {
            position: relative;
            flex-grow: 1;
        }
        
        .search-input {
            width: 100%;
            padding: 1.5rem 1.5rem 1.5rem 4rem;
            border: 3px solid var(--border-color);
            border-radius: var(--border-radius-large);
            font-size: 1.1rem;
            background: var(--bg-card);
            color: var(--text-primary);
            transition: all var(--transition-smooth);
            box-shadow: var(--shadow-soft);
            font-family: 'Comfortaa', sans-serif;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(212, 147, 90, 0.2), var(--shadow-medium);
            transform: translateY(-2px);
        }
        
        .search-input::placeholder {
            color: var(--text-muted);
            font-weight: 400;
        }
        
        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 1.4rem;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1.2rem;
        }
        
        .cart-badge {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-bounce);
            font-size: 1.3rem;
            position: relative;
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-soft);
        }
        
        .cart-badge:hover {
            transform: scale(1.15);
            box-shadow: var(--shadow-strong);
        }
        
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--error-color);
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            animation: heartbeat 2s infinite;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4);
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
            75% { transform: scale(1.1); }
        }

        /* PROMO SECTION */
        .promo-section {
            margin: 1.5rem 0;
        }
        .promo-box {
            background: var(--gradient-primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius-medium);
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            position: relative;
            box-shadow: var(--shadow-soft);
            animation: pulse 2s infinite;
        }
        .promo-box strong {
            font-size: 1.4rem;
            text-shadow: 0 0 8px rgba(255,255,255,0.6);
        }
        .promo-sub {
            display: block;
            font-size: 0.9rem;
            font-weight: 400;
            margin-top: 0.3rem;
            opacity: 0.9;
        }
        .promo-close {
            position: absolute;
            top: 8px;
            right: 12px;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .promo-close:hover {
            transform: scale(1.2);
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(212, 147, 90, 0.6); }
            70% { box-shadow: 0 0 0 20px rgba(212, 147, 90, 0); }
            100% { box-shadow: 0 0 0 0 rgba(212, 147, 90, 0); }
        }
        .promo-hide {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 0.4s, transform 0.4s;
        }
        
        /* CONTAINER & LOADING */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem 3rem;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
            font-size: 1.3rem;
            color: var(--text-muted);
            font-family: 'Comfortaa', sans-serif;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1.5s ease-in-out infinite;
            margin-right: 1.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* PRODUCT LIST & CARD */
        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 2.5rem;
        }
        
        .product-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-large);
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            transition: all var(--transition-smooth);
            position: relative;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .product-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-strong);
            border-color: rgba(212, 147, 90, 0.3);
        }
        
        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-overlay);
            opacity: 0;
            transition: opacity var(--transition-smooth);
            pointer-events: none;
            z-index: 1;
        }
        
        .product-card:hover::before {
            opacity: 1;
        }
        
        .gallery {
            position: relative;
            overflow: hidden;
            background: var(--bg-secondary);
        }
        
        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all var(--transition-smooth);
            filter: brightness(1.05) saturate(1.1);
            border-radius: 10px;
        }
        
        .product-card:hover .gallery-image {
            transform: scale(1.15);
            filter: brightness(1.1) saturate(1.2);
        }
        
        .product-info {
            padding: 2rem;
            position: relative;
            z-index: 2;
        }
        
        .title {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            line-height: 1.3;
            color: var(--text-primary);
        }
        
        .weight {
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .weight i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        .price-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .current-price {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-color);
            text-shadow: 0 1px 2px rgba(212, 147, 90, 0.2);
        }
        
        .original-price {
            font-size: 1.1rem;
            color: var(--text-muted);
            text-decoration: line-through;
            opacity: 0.8;
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .add-to-cart-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            transition: all var(--transition-bounce);
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
        }
        
        .add-to-cart-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all var(--transition-smooth);
        }
        
        .add-to-cart-btn:hover::before {
            width: 100%;
            height: 100%;
        }
        
        .add-to-cart-btn:hover {
            transform: scale(1.2) rotate(15deg);
            box-shadow: var(--shadow-strong);
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: var(--gradient-secondary);
            border-radius: var(--border-radius-medium);
            padding: 0.8rem 1.2rem;
            box-shadow: var(--shadow-soft);
        }
        
        .quantity-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            transition: all var(--transition-bounce);
            box-shadow: 0 2px 8px rgba(212, 147, 90, 0.3);
        }
        
        .quantity-btn:hover {
            background: var(--primary-hover);
            transform: scale(1.15);
        }
        
        .quantity {
            font-family: 'Comfortaa', sans-serif;
            font-weight: 700;
            min-width: 32px;
            text-align: center;
            font-size: 1.1rem;
            color: var(--text-primary);
        }
        
        .details-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: all var(--transition-smooth);
            padding: 0.5rem;
            border-radius: var(--border-radius-soft);
        }
        
        .details-btn:hover {
            background: rgba(212, 147, 90, 0.1);
            color: var(--primary-hover);
            transform: translateY(-1px);
        }
        
        .details-btn i {
            margin-right: 0.5rem;
        }

        /* MODAL */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(139, 69, 19, 0.7);
            backdrop-filter: var(--blur-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-smooth);
            padding: 2rem;
        }
        
        .modal-backdrop.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--bg-card);
            border-radius: var(--border-radius-large);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-strong);
            transform: scale(0.8) translateY(50px);
            transition: all var(--transition-bounce);
            border: 2px solid var(--border-color);
        }
        
        .modal-backdrop.visible .modal-content {
            transform: scale(1) translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem;
            border-bottom: 2px solid var(--border-color);
            background: var(--gradient-secondary);
        }
        
        .modal-title {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .modal-close {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            transition: all var(--transition-bounce);
            box-shadow: var(--shadow-soft);
        }
        
        .modal-close:hover {
            background: var(--error-color);
            color: white;
            transform: scale(1.15) rotate(90deg);
        }
        
        .modal-body {
            padding: 2rem;
            line-height: 1.7;
            color: var(--text-secondary);
            font-size: 1.05rem;
        }

        /* ORDER FORM */
        .order-form {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top-left-radius: var(--border-radius-large);
            border-top-right-radius: var(--border-radius-large);
            max-height: 90vh;
            overflow-y: auto;
            z-index: 1500;
            transform: translateY(100%);
            transition: transform var(--transition-smooth);
            box-shadow: 0 -10px 40px rgba(212, 147, 90, 0.3);
            border-top: 3px solid var(--primary-color);
        }
        
        .order-form.visible {
            transform: translateY(0);
        }
        
        .order-form-content {
            padding: 2.5rem;
            position: relative;
        }
        
        .order-form-close-btn {
            position: absolute;
            top: 2rem;
            right: 2rem;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transition: all var(--transition-bounce);
            z-index: 10;
            box-shadow: var(--shadow-soft);
        }
        
        .order-form-close-btn:hover {
            background: var(--error-color);
            color: white;
            transform: scale(1.15) rotate(90deg);
        }
        
        .order-form h2 {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: var(--text-primary);
        }
        
        .change-order-btn {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            margin-bottom: 2rem;
            transition: all var(--transition-smooth);
            font-weight: 600;
        }
        
        .change-order-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }
        
        .summary-item {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius-medium);
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
        }
        
        .summary-item-img {
            width: 64px;
            height: 64px;
            border-radius: var(--border-radius-medium);
            object-fit: cover;
            box-shadow: var(--shadow-soft);
        }
        
        .summary-item-details {
            flex: 1;
        }
        
        .summary-item-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .summary-item-quantity {
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        .summary-item-price {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .summary-totals {
            background: var(--bg-secondary);
            border-radius: var(--border-radius-large);
            padding: 1.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
        }
        
        .summary-totals>div {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 1.05rem;
        }
        
        .total-price {
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--primary-color);
            border-top: 2px solid var(--border-color);
            padding-top: 1rem;
            margin-top: 1rem;
        }
        
        .total-discount {
            color: var(--success-color);
            font-weight: 600;
        }
        
        .delivery-options {
            margin-bottom: 2rem;
        }
        
        .delivery-option {
            display: flex;
            align-items: center;
            padding: 1.2rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-medium);
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all var(--transition-smooth);
        }
        
        .delivery-option:hover {
            border-color: var(--primary-color);
            background: rgba(212, 147, 90, 0.05);
        }
        
        .delivery-option input[type="radio"] {
            margin-right: 1rem;
            transform: scale(1.2);
            accent-color: var(--primary-color);
        }
        
        .delivery-option label {
            flex: 1;
            cursor: pointer;
        }
        
        .delivery-option .price {
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .address-field {
            margin-bottom: 2rem;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: all var(--transition-smooth);
        }
        
        .address-field.visible {
            opacity: 1;
            max-height: 100px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group input,
        .address-field input {
            width: 100%;
            padding: 1.2rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-medium);
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all var(--transition-smooth);
            font-family: 'Comfortaa', sans-serif;
        }
        
        .form-group input:focus,
        .address-field input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(212, 147, 90, 0.2);
            transform: translateY(-2px);
        }
        
        .error {
            color: var(--error-color);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 500;
        }
        
        .order-notice {
            background: rgba(212, 147, 90, 0.1);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-medium);
            padding: 1.2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .order-notice i {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        /* INFO SECTIONS */
        .info-section {
            padding: 4rem 0;
            background: var(--bg-card);
            margin-top: 3rem;
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-soft);
        }
        
        #reviews {
            background: var(--bg-secondary);
        }
        
        .section-title {
            text-align: center;
            font-family: 'Comfortaa', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 3rem;
            color: var(--text-primary);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .about-content {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 3rem;
            align-items: center;
        }
        
        .about-image img {
            width: 100%;
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-medium);
            transition: all var(--transition-smooth);
        }
        
        .about-image img:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-strong);
        }
        
        .about-text h3 {
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .about-text p {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }
        
        .review-card {
            background: var(--bg-card);
            padding: 2rem;
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-soft);
            border: 2px solid var(--border-color);
            transition: all var(--transition-smooth);
        }
        
        .review-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .review-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .review-header .fa-user-circle {
            font-size: 3.5rem;
            color: var(--primary-color);
        }
        
        .reviewer-name {
            font-family: 'Comfortaa', sans-serif;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
            color: var(--text-primary);
        }
        
        .review-stars {
            color: var(--warning-color);
            font-size: 1.1rem;
        }
        
        .review-text {
            color: var(--text-secondary);
            font-style: italic;
            line-height: 1.7;
            font-size: 1.05rem;
        }

        /* АДАПТИВНІСТЬ */
        @media (max-width: 768px) {
            .about-content {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 2rem;
            }
            .product-list {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }
            .header-content {
                padding: 0 1rem;
            }
            .container {
                padding: 0 1rem 2rem;
            }
        }
        
        @media (max-width: 480px) {
            .product-list {
                grid-template-columns: 1fr;
            }
            .logo {
                font-size: 1.4rem;
            }
            .section-title {
                font-size: 2rem;
            }
            .search-input {
                padding-left: 1.5rem; /* Зменшуємо відступ для мобільних */
            }
            .search-icon {
                display: none; /* Приховуємо іконку для економії місця */
            }
        }
    </style>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>
  <header class="header">
    <div class="header-content">
        <!-- Логотип приховано, оскільки це Telegram WebApp, і фокус на товарах -->
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="Пошук сирів..." id="search-input">
        </div>
        <div class="header-actions">
            <!-- Кнопка "Кошик" (для візуального підтвердження, хоча основна кнопка - TG MainButton) -->
            <button class="cart-badge" id="cart-badge" title="Кошик">
                <span class="cart-count hidden" id="cart-count">0</span>
                <i class="fas fa-shopping-cart"></i>
            </button>
        </div>
    </div>
</header>

<!-- 🔔 Повідомлення про знижку -->
<section class="promo-section" id="promo-section">
  <div class="container">
    <div class="promo-box">
      🎉 Лише зараз! <strong>-15%</strong> на всі сири 🧀  
      <span class="promo-sub">Встигніть замовити до кінця тижня!</span>
      <button class="promo-close" id="promo-close">×</button>
    </div>
  </div>
</section>

<div class="container">
    <div class="loading" id="loading">
        <div class="spinner"></div>
        Завантаження каталогу...
    </div>
    <div class="product-list" id="product-list"></div>
</div>

<!-- Секція відгуків -->
<section id="reviews" class="info-section">
    <div class="container">
        <h2 class="section-title">Відгуки наших клієнтів</h2>
        <div class="reviews-grid">
            <div class="review-card">
                <div class="review-header">
                    <i class="fas fa-user-circle"></i>
                    <div>
                        <p class="reviewer-name">Олена П.</p>
                        <div class="review-stars">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                                class="fas fa-star"></i><i class="fas fa-star"></i>
                        </div>
                    </div>
                </div>
                <p class="review-text">"Неймовірно смачний сир! Гауда просто тане в роті. Відчувається, що продукт
                    натуральний і зроблений з душею. Обов'язково замовлю ще!"</p>
            </div>
            <div class="review-card">
                <div class="review-header">
                    <i class="fas fa-user-circle"></i>
                    <div>
                        <p class="reviewer-name">Андрій</p>
                        <div class="review-stars">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                                class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                        </div>
                    </div>
                </div>
                <p class="review-text">"Замовляв доставку по Обухову, все привезли швидко. Сир свіжий, ароматний.
                    Трохи дорожче, ніж в магазині, але якість того варта."</p>
            </div>
        </div>
    </div>
</section>

<!-- Секція "Про Нас" -->
<section id="about-us" class="info-section">
    <div class="container">
        <h2 class="section-title">Про Нас</h2>
        <div class="about-content">
            <div class="about-image">
                <img src="data/pro_nas.png" alt="Наша сироварня">
            </div>
            <div class="about-text">
                <h3>Сімейна справа з любов'ю до сиру</h3>
                <p>
                    <strong>Family Cheese</strong> — це невелика сімейна сироварня, де ми створюємо натуральні сири
                    за традиційними рецептами. Кожна головка сиру — це результат ручної праці, якісного молока та
                    нашої пристрасті до сироваріння. Ми віримо, що найкращий продукт народжується лише з найкращих
                    інгредієнтів та дбайливого ставлення.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Модальне вікно для детального опису товару -->
<div class="modal-backdrop" id="description-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title" id="modal-title"></h2>
            <button class="modal-close" id="modal-close-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body" id="modal-body"></div>
    </div>
</div>

<!-- Форма замовлення (виїжджає знизу) -->
<div id="order-form" class="order-form">
    <div class="order-form-content">
        <h2>Ваше замовлення</h2>
        <button class="order-form-close-btn" id="order-form-close-btn" title="Закрити">
            <i class="fas fa-times"></i>
        </button>
        
        <div id="order-summary"></div>
        
        <button class="change-order-btn">
            <i class="fas fa-edit"></i>
            Змінити замовлення
        </button>

        <div class="delivery-options">
            <h2>Спосіб доставки</h2>
            <div class="delivery-option">
                <input type="radio" id="obukhiv-delivery" name="delivery" value="50" data-title="Доставка по м. Обухів" checked>
                <label for="obukhiv-delivery">
                    <b>Доставка по м. Обухів</b>
                </label>
                <span class="price">50 грн</span>
            </div>
            <div class="delivery-option">
                <input type="radio" id="nova-poshta" name="delivery" value="0" data-title="Нова Пошта">
                <label for="nova-poshta">
                    <b>Нова Пошта</b><br>
                    За тарифами перевізника
                </label>
            </div>
        </div>

        <div id="address-field-container" class="address-field visible">
            <input type="text" id="address-input" placeholder="Введіть вашу адресу або № відділення">
        </div>

        <h2>Контактні дані</h2>
        <p class="error" id="form-error"></p>
        <div class="form-group">
            <input type="text" id="user-name" placeholder="Ім'я та Прізвище">
        </div>
        <div class="form-group">
            <input type="tel" id="user-phone" placeholder="0 XX XXX XX XX">
        </div>

        <div class="order-notice">
            <i class="fas fa-info-circle"></i>
            Фінальна сума замовлення може дещо змінитися після зважування товару.
        </div>
        <div class="order-notice">
            <i class="fas fa-credit-card"></i>
            Оплата після отримання замовлення.
        </div>
    </div>
</div>

<script type="module">
    // --- ДАНІ ПРОДУКТІВ (products.json) ---
    const MOCK_PRODUCTS_DATA = [
        { "id": "Гауда50", "name": "Сир твердий «Гауда» 50%", "price": 163.2, "original_price": 192, "is_hit": false, "description": "Твердий сир з м'яким кремовим смаком, виготовлений зі справжнього коров’ячого молока та закваски. Сир містить вітаміни A, B, C, D,E, K, насичує організм селеном, залізом, цинком, йодом, кальцієм та калієм. Особливо корисно вживати цей сир на сніданок!", "weight": "ваккум, ~400 г", "images": ["data/gauda.jpg"] },
        { "id": "Рікотта", "name": "Сир м'який «Рікотта»", "price": 89.25, "original_price": 105, "is_hit": false, "description": "Солодкуватий на смак за рахунок лактози, що входить до його складу. Це - король серед всіх білкових молочних продуктів. Рікотта, вагою 400 грамів містить до 96 грамів білка. Мало жиру і багато білка - ідеальний продукт для людей, які вирішили «сісти» на дієту з метою схуднення.", "weight": "ваккум, ~500 г", "images": ["data/ricotta.jpeg"] },
        { "id": "Масло", "name": "Масло «Домашнє»", "price": 183.6, "original_price": 216, "is_hit": false, "description": "Вершки збиті в маслобійці! В першу чергу відповідає за гладку шкіру, гарне волосся і міцні нігті, а все тому, що в ньому містяться жиророзчинні вітаміни А, D, E, K.", "weight": "пак, ~400 г", "images": ["data/maslo.jpeg"] },
        { "id": "Моцарелла", "name": "Сир «Моцарелла»", "price": 111.5625, "original_price": 131.25, "is_hit": false, "description": "Класичний італійський м’який розсільний сир. Смакує в салатах, закусках, відмінно плавиться. Дуже ніжний та корисний!", "weight": "ваккум, ~350 г", "images": ["data/mocarella.jpeg"] },
        { "id": "Фета", "name": "Сир «Фета»", "price": 55.8875, "original_price": 65.75, "is_hit": false, "description": "Фета, Фетакі — популярний грецький сир. Слово «фета» італійського походження і означає «скибка ». Фета належить до групи м'яких сирів, його жирність становить 8%.", "weight": "ваккум, ~250 г", "images": ["data/feta.jpeg"] },
        { "id": "Гауда35", "name": "Сир твердий «Гауда» 35%", "price": 158.1, "original_price": 186, "is_hit": false, "description": "Твердий сир з м'яким кремовим смаком, виготовлений зі справжнього коров’ячого молока та закваски. Сир містить вітаміни A, B, C, D,E, K, насичує організм селеном, залізом, цинком, йодом, кальцієм та калієм. Особливо корисно вживати цей сир на сніданок!", "weight": "ваккум, ~400 г", "images": ["data/gauda35.jpg"] },
        { "id": "Чеддер", "name": "Сир твердий «Чеддер»", "price": 178.5, "original_price": 210, "is_hit": false, "description": "Цей популярний англійський сир відрізняється однорідною текстурою, маслянистої, що кришиться і злегка мажущейся консистенцією, а також багатим сирним смаком. Для його виробництва використовується натуральне коров`яче молоко. Період дозрівання зазвичай становить від 3 місяців. Чеддер прекрасно підходить для приготування гарнірів, салатів і закусок.", "weight": "ваккум, ~400 г", "images": ["data/chedder.jpeg"] },
        { "id": "Плавлений", "name": "Сир плавлений", "price": 53.55, "original_price": 63, "is_hit": false, "description": "Що може бути приємніше і ситніше вранці, ніж  плавлений сир? Він прекрасно наноситься на хліб і відмінно втамовує голод. Він сподобається дорослим і дітям. Це дуже ніжний вершковий продукт. Плавлений сир - відмінний початок дня для всієї родини.", "weight": "банк, ~1 000 г", "images": ["data/plavleny.jpg"] },
        { "id": "Вершки", "name": "Вершки", "price": 119, "original_price": 140, "is_hit": false, "description": "Мають жирність 25-30%. Вони відмінно поєднуються з кавою, надаючи їй особливо ніжного і м`якого смаку.Вершки можна використовувати для приготування смачних десертів і домашнього морозива.", "weight": "пляш, 1 шт", "images": ["data/slivki.jpg"] },
        { "id": "Адигейський", "name": "Сир м'який «Адигейський»", "price": 161.2875, "original_price": 189.75, "is_hit": false, "description": "Сир Адигейський — м'який сир традиційний для передгір'я та гірських районів Кавказу. \nМи виготовляємо його з відбірного фермерського молока. Має ніжний вершковий смак.\nЖирність 40%.\n☝️При виробництві продукції для збереження корисних властивостей молока ми використовуємо лагідну пастерізація при температурі 65~67°C.\n☺️Використання :\n✔️для додавання у салати\n✔️для бутербродів\n✔️ і просто до чаю чи кави☕", "weight": "ваккум, ~550 г", "images": ["data/adygeyskiy.jpg"] },
        { "id": "Блек", "name": "Сир твердий «Black edition»", "price": 187.425, "original_price": 220.5, "is_hit": false, "description": "Black Edition, жирністю 50%, термін дозрівання 50 днів. Має легкий аромат тропічних фруктів, завдяки доданому кокосовому вугіллю. Трендовий сир для подарунку чи святкового столу.", "weight": "ваккум, ~350 г", "images": ["data/black.jpg"] },
        { "id": "Бринза", "name": "Бринза", "price": 143.4375, "original_price": 168.75, "is_hit": false, "description": "Бринза - молодий розсільний сир жирністю 35%. У складі тільки відбірне молоко, закваска та сіль. \nМінімально просто, максимально корисно.\nСмакує з літніми салатами чи просто як корисний поживний перекус.", "weight": "ваккум, ~450 г", "images": ["data/brynza.jpg"] },
        { "id": "ГаудаПажитником", "name": "«Гауда» 50% з пажитником", "price": 168.3, "original_price": 198, "is_hit": false, "description": "Пажитник (він же шамбала, хельба, фенугрек) - однорічна трава із сімейства бобових, що росте в басейні Середземного моря та в деяких азіатських країнах (Туреччина, Індія, Іран, Ірак). \nНасіння, яке ми додаємо до нашого сиру Гауда, ховається всередині плодів-вузьких вигнутих стручків. Якщо його підсмажити, з'являється солодкуватий горіховий присмак.\nНасіння пажитнику містить близько 27% білка, а також має високий вміст калію, кальцію, магнібю а фосфору.\nУ народі рослина отримала назву \"трава від ста хвороб\", і вона повністю виправдовує себе.\nПажитник має у своєму багатому складі галактоманнан - харчове волокно, що знижує апетит і рівень глюкози. Також він сприяє поліпшенню роботи головного мозку, знижує концентрацію \"поганого\" холестерину, підтримує еластичність судин, покращує стан шкіри, нігтів і волосся. \nТак пажитником додає нашому сиру Гауді не тільки приємний горіховий смак, а й додаткову користь. ", "weight": "ваккум, ~400 г", "images": ["data/pagytnik.jpg"] },
        { "id": "Лабне", "name": "Лабне", "price": 114.75, "original_price": 135, "is_hit": false, "description": "Лабне - молодий розсільний сир, з травами та часником у оливковій олії.\nВиготовляється з йогурту, період дозрівання 2-3 дні. За консистенцією нагадує щось середнє між сиром і йогуртом.\nНаш лабне має ніжний, вершковий смак та легкий аромат часнику.\nЛабне – це традиційний крем-сир кухні країн Близького Сходу, приготований із йогурту. Назва «Лабне» з арабської означає «молоко» або «білий».\nІдеально для додавання у салати та як намазка на тости.\nЖирність 40%\nВага 100 г.\nТермін зберігання в олії 30 діб", "weight": "банк, 1 шт", "images": ["data/labne.jpg"] },
        { "id": "МаслоШоколадне", "name": "Масло шоколадне", "price": 182.9625, "original_price": 215.25, "is_hit": false, "description": "Шоколадне масло TM Family cheese занурить вас у дитинство\nНеймовірно смачне, з натуральних вершків з додаванням високоякісного какао-порошку. Пластична структура, ідеальна для бутербродів, кремів чи десертів.\nФасуємо шматочками по ~ 350 г (але радимо замовляти одразу два і більше, бо, коли його куштуєш, зупинитись вже неможливо)", "weight": "пак, ~350 г", "images": ["data/masloshokolad.jpg"] },
        { "id": "ПестоЗеленеЧервоне", "name": "Сир твердий «Песто»", "price": 187.18, "original_price": 220.5, "is_hit": false, "description": "Песто з італійськими травами \nЖирність 50%. Витримка 50 днів. \nРобимо зручну фасовку по 300 г.\nСмак витончений та злегка освіжаючий, завдяки доданому сушеному базиліку", "weight": "ваккум, ~350 г", "images": ["data/pesto.jpg"] },
        { "id": "Халумі", "name": "Халумі", "price": 95.625, "original_price": 112.5, "is_hit": false, "description": "Халумі - дуже популярний в країнах Середземномор'я сир для смаження чи приготуванні на грилі.\nМає високу температуру плавлення, завдяки чому може бути обсмажений до золотавої скоринки. При цьому залишиться ніжним всередині. \nХалумі - це розсільний сир, має шарувату волокнисту структуру схожу на моцарелу та злегка солений смак.\nГарно поєднується з овочами, відмінно смакує в салатах або як окрема страва-гриль.\nСклад, як і в усіх наших сирів, абсолютно натуральний: відбірне фермерське молоко, закваска та сіль.\nТакож маємо в асортименті халумі з м'ятою, яка ідеально доповнює його смак.\nФасовка 250-350 г, зручні шматочки у вакуумі.", "weight": "ваккум, ~300 г", "images": ["data/halumi.jpg"] }
    ];

    // --- СТАН (AppState.js) ---
    const AppState = {
        products: [],
        cart: {},
        isFormVisible: false,
        tg: null, // Ініціалізується при запуску
    };

    // Колекція основних елементів DOM
    const elements = {
        // General
        loading: document.getElementById('loading'),
        productList: document.getElementById('product-list'),
        searchInput: document.getElementById('search-input'),
        
        // Header
        cartBadge: document.getElementById('cart-badge'),
        cartCount: document.getElementById('cart-count'),
        
        // Promo
        promoSection: document.getElementById('promo-section'),
        promoCloseBtn: document.getElementById('promo-close'),

        // Order Form
        orderForm: document.getElementById('order-form'),
        orderFormCloseBtn: document.getElementById('order-form-close-btn'),
        changeOrderBtn: document.querySelector('.change-order-btn'),
        deliveryOptions: document.querySelectorAll('input[name="delivery"]'),
        addressContainer: document.getElementById('address-field-container'),
        orderSummary: document.getElementById('order-summary'),

        // Form inputs
        userNameInput: document.getElementById("user-name"),
        userPhoneInput: document.getElementById("user-phone"),
        addressInput: document.getElementById("address-input"),
        formError: document.getElementById("form-error"),

        // Modal
        modal: document.getElementById('description-modal'),
        modalTitle: document.getElementById('modal-title'),
        modalBody: document.getElementById('modal-body'),
        modalCloseBtn: document.getElementById('modal-close-btn'),
    };

    // --- КОМПОНЕНТИ ---
    // ProductCard.js
    function createProductElement(product) {
        const card = document.createElement("div");
        card.className = "product-card";
        card.dataset.id = product.id;

        const priceHTML = product.original_price
            ? `<span class="current-price">${product.price.toFixed(2)} грн</span><span class="original-price">${product.original_price.toFixed(2)} грн</span>`
            : `<span class="current-price">${product.price.toFixed(2)} грн</span>`;

        card.innerHTML = `
            <div class="gallery"><img src="${product.images[0]}" alt="${product.name}" class="gallery-image" onerror="this.onerror=null;this.src='https://placehold.co/400x300/F0E6D6/8B4513?text=Family+Cheese';"></div>
            <div class="product-info">
                <div class="title">${product.name}</div>
                <div class="weight"><i class="fas fa-weight"></i> ${product.weight}</div>
                <div class="price-container">${priceHTML}</div>
                <div class="card-footer">
                    <button class="add-to-cart-btn" title="Додати в кошик"><i class="fas fa-plus"></i></button>
                    <div class="quantity-control" style="display: none;">
                        <button class="quantity-btn" data-action="decrease"><i class="fas fa-minus"></i></button>
                        <span class="quantity">1</span>
                        <button class="quantity-btn" data-action="increase"><i class="fas fa-plus"></i></button>
                    </div>
                    <button class="details-btn" data-title="${product.name}" data-description="${product.description.replace(/"/g, '&quot;')}">
                        <i class="fas fa-info-circle"></i> Детальніше
                    </button>
                </div>
            </div>`;
        return card;
    }

    // Cart.js
    function updateCart(productId, action) {
        const product = AppState.products.find(p => p.id == productId);
        if (!product) return;

        if (action === 'add' && !AppState.cart[productId]) {
            AppState.cart[productId] = { name: product.name, price: product.price, quantity: 1 };
        } else if (action === 'increase' && AppState.cart[productId]) {
            AppState.cart[productId].quantity++;
        } else if (action === 'decrease' && AppState.cart[productId]) {
            AppState.cart[productId].quantity--;
            if (AppState.cart[productId].quantity <= 0) {
                delete AppState.cart[productId];
            }
        }
        
        updateUI();
    }

    // OrderForm.js
    function openOrderForm() {
        AppState.isFormVisible = true;
        renderOrderSummary();
        toggleAddressField();
        elements.orderForm.classList.add("visible");
        AppState.tg?.BackButton.show();
        updateUI();
    }

    function closeOrderForm() {
        AppState.isFormVisible = false;
        elements.orderForm.classList.remove("visible");
        AppState.tg?.BackButton.hide();
        updateUI();
    }

    function renderOrderSummary() {
        if (!elements.orderSummary) return;

        let itemsHTML = "";
        let productsTotal = 0;
        let totalDiscount = 0;

        for (const id in AppState.cart) {
            const product = AppState.products.find(p => p.id == id);
            const item = AppState.cart[id];
            if (!product) continue;

            const itemTotalPrice = item.price * item.quantity;
            productsTotal += itemTotalPrice;

            if (product.original_price) {
                totalDiscount += (product.original_price - item.price) * item.quantity;
            }

            itemsHTML += `
                <div class="summary-item">
                    <img src="${product.images[0]}" alt="${item.name}" class="summary-item-img" onerror="this.onerror=null;this.src='https://placehold.co/64x64/F0E6D6/8B4513?text=🧀';">
                    <div class="summary-item-details">
                        <div class="summary-item-name">${item.name}</div>
                        <div class="summary-item-quantity">${item.quantity} x ${item.price.toFixed(2)} грн</div>
                    </div>
                    <div class="summary-item-price">${itemTotalPrice.toFixed(2)} грн</div>
                </div>`;
        }

        const selectedDelivery = document.querySelector('input[name="delivery"]:checked');
        const deliveryCost = parseInt(selectedDelivery ? selectedDelivery.value : "0", 10) || 0;
        const finalTotal = productsTotal + deliveryCost;

        const totalsHTML = `
            <div class="summary-totals">
                ${totalDiscount > 0 ? `<div class="total-discount"><span><i class="fas fa-tags"></i> Ваша знижка:</span><span>-${totalDiscount.toFixed(2)} грн</span></div>` : ""}
                ${deliveryCost > 0 ? `<div><span><i class="fas fa-truck"></i> Доставка:</span><span>${deliveryCost.toFixed(2)} грн</span></div>` : ""}
                <div class="total-price">
                    <span><i class="fas fa-receipt"></i> Всього до сплати:</span>
                    <span>${finalTotal.toFixed(2)} грн</span>
                </div>
            </div>`;

        elements.orderSummary.innerHTML = itemsHTML + totalsHTML;
    }

    function toggleAddressField() {
        const selectedDeliveryId = document.querySelector('input[name="delivery"]:checked')?.id;
        const isAddressNeeded = selectedDeliveryId === "obukhiv-delivery" || selectedDeliveryId === "nova-poshta";
        elements.addressContainer.classList.toggle("visible", isAddressNeeded);
    }

    // --- СЕРВІСИ ---
    // telegram.service.js
    function initializeTelegramWebApp() {
        try {
            AppState.tg = window.Telegram?.WebApp;
            if (AppState.tg) {
                AppState.tg.ready();
                AppState.tg.expand();
            } else {
                // Mock object for browser testing if TG is not available
                AppState.tg = {
                    initData: 'dev_mode_init_data',
                    initDataUnsafe: { user: { id: 'demo_user', first_name: 'Test', last_name: 'User' } },
                    MainButton: {
                        setText: (text) => console.log('TG MainButton Text:', text),
                        show: () => console.log('TG MainButton: Show'),
                        hide: () => console.log('TG MainButton: Hide'),
                        setParams: (params) => console.log('TG MainButton Params:', params),
                        onClick: (callback) => console.log('TG MainButton Click Registered'),
                    },
                    BackButton: {
                        show: () => console.log('TG BackButton: Show'),
                        hide: () => console.log('TG BackButton: Hide'),
                        onClick: (callback) => console.log('TG BackButton Click Registered'),
                    },
                    onEvent: (event, callback) => {
                        if (event === 'mainButtonClicked' || event === 'backButtonClicked') {
                            // Mock registration for browser environment
                            if (event === 'mainButtonClicked') elements.cartBadge.addEventListener('click', callback);
                            if (event === 'backButtonClicked') elements.orderFormCloseBtn.addEventListener('click', callback);
                        }
                    },
                    close: () => console.log('TG Close'),
                    showAlert: (message) => console.log(`[TG Alert]: ${message}`), // Using console log instead of alert
                };
            }
        } catch (e) {
            console.warn(`Error initializing Telegram WebApp: ${e.message}`);
        }
    }

    // api.service.js
    const API_URLS = {
        PRODUCTS: './data/products.json', // Залишаємо для гнучкості, але використовуємо вбудовані дані
        USER_DATA: 'https://urfine.com.ua/fct/hs/bots/user/',
        SUBMIT_ORDER: 'https://urfine.com.ua/fct/hs/bots/order/'
    };

    function generateMockProducts() {
        console.warn("Using mock product data from embedded JSON.");
        return MOCK_PRODUCTS_DATA;
    }

    async function loadProducts() {
        elements.loading.style.display = 'flex';
        // Оскільки файли об'єднані, використовуємо вбудовані дані
        AppState.products = generateMockProducts();
        elements.loading.style.display = 'none';
        
        // Тут можна було б додати спробу завантажити з API_URLS.PRODUCTS, 
        // але для одного файлу HTML це не потрібно.
    }

    async function fetchUserData() {
        if (!AppState.tg || !AppState.tg.initDataUnsafe?.user) return;
        try {
            // Для цієї емуляції ми просто заповнимо ім'я користувача Telegram
            const user = AppState.tg.initDataUnsafe.user;
            elements.userNameInput.value = `${user.first_name} ${user.last_name || ''}`.trim();

            // Якщо ви запускаєте це в реальному TG WebApp, розкоментуйте POST запит:
            /*
            const response = await fetch(API_URLS.USER_DATA, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Telegram-Init-Data': AppState.tg.initData },
                body: JSON.stringify({ initData: AppState.tg.initData, userId: user.id })
            });
            if (!response.ok) throw new Error(`Помилка мережі: ${response.status}`);
            const data = await response.json();
            elements.userNameInput.value = elements.userNameInput.value || data.name || `${user.first_name} ${user.last_name || ''}`.trim();
            elements.userPhoneInput.value = elements.userPhoneInput.value || data.phone || '';
            elements.addressInput.value = elements.addressInput.value || data.address || '';
            */
        } catch (error) {
            console.error('Не вдалося отримати дані користувача:', error.message);
        }
    }

    async function postOrder(data) {
        console.log("Sending order data:", data);
        try {
            // Реальний POST-запит до бекенду
            const response = await fetch(API_URLS.SUBMIT_ORDER, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (!response.ok) {
                throw new Error(`Помилка відправки замовлення: ${response.status}`);
            }
            console.log('Замовлення успішно відправлено!');
            AppState.tg?.showAlert('Ваше замовлення прийнято! Очікуйте на повідомлення в telegram.');
        } catch (error) {
            console.error(error.message);
            AppState.tg?.showAlert(`Помилка відправки: ${error.message}`);
        } finally {
            AppState.tg?.close();
        }
    }

    function submitOrder() {
        const orderData = validateOrderForm();
        if (!orderData) return; // Validation failed
        
        AppState.tg?.showAlert('Ваше замовлення прийнято! Очікуйте на повідомлення в telegram.');
        postOrder(orderData);
    }

    // --- УТИЛІТИ ---
    // validators.js
    function validateOrderForm() {
        elements.formError.textContent = "";

        // 1. Валідація імені
        if (elements.userNameInput.value.trim().length < 3) {
            elements.formError.textContent = "Введіть коректне ім'я та прізвище.";
            elements.userNameInput.focus();
            return null;
        }

        // 2. Валідація телефону
        if (!/^\+?3?8?(0\d{9})$/.test(elements.userPhoneInput.value.replace(/\s/g, ""))) {
            elements.formError.textContent = "Введіть телефон у форматі 0XXXXXXXXX.";
            elements.userPhoneInput.focus();
            return null;
        }

        // 3. Валідація адреси
        if (elements.addressContainer.classList.contains("visible") && elements.addressInput.value.trim().length < 5) {
            elements.formError.textContent = "Будь ласка, введіть адресу або № відділення.";
            elements.addressInput.focus();
            return null;
        }

        // --- Якщо валідація пройдена, формуємо об'єкт замовлення ---
        let rawTotalPrice = 0;
        let rawTotalDiscount = 0;
        const cartAsArray = Object.keys(AppState.cart).map(id => {
            const product = AppState.products.find(p => p.id == id);
            const item = AppState.cart[id];
            rawTotalPrice += item.price * item.quantity;
            if (product && product.original_price) {
                rawTotalDiscount += (product.original_price - item.price) * item.quantity;
            }
            return { id, ...item };
        });

        const selectedDelivery = document.querySelector('input[name="delivery"]:checked');
        const deliveryData = {
            id: selectedDelivery.id,
            title: selectedDelivery.dataset.title,
            cost: parseInt(selectedDelivery.value, 10) || 0,
            address: elements.addressInput.value
        };

        const userId = AppState.tg.initDataUnsafe?.user?.id || 'browser_user';
        const initData = AppState.tg.initData || 'browser_init_data';

        return {
            userId: userId,
            user: { name: elements.userNameInput.value, phone: elements.userPhoneInput.value },
            initData: initData,
            cart: cartAsArray,
            totalPrice: (rawTotalPrice + deliveryData.cost).toFixed(2),
            totalDiscount: rawTotalDiscount.toFixed(2),
            delivery: deliveryData
        };
    }

    // --- UI МЕНЕДЖМЕНТ ---
    // uiManager.js
    function renderProducts() {
        const query = elements.searchInput.value.toLowerCase();
        const filteredProducts = AppState.products.filter(p =>
            p.name.toLowerCase().includes(query) || p.description.toLowerCase().includes(query)
        );

        elements.productList.innerHTML = "";
        if (filteredProducts.length === 0) {
            elements.productList.innerHTML = `<div style="grid-column: 1/-1; text-align: center; padding: 2rem;"><h3>Товари не знайдено</h3></div>`;
            return;
        }
        filteredProducts.forEach(product => {
            elements.productList.appendChild(createProductElement(product));
        });
    }

    function updateCartControls() {
        document.querySelectorAll('.product-card').forEach(card => {
            const id = card.dataset.id;
            const addBtn = card.querySelector('.add-to-cart-btn');
            const quantityControl = card.querySelector('.quantity-control');
            
            if (AppState.cart[id]) {
                setTimeout(() => {
                    addBtn.style.display = 'none';
                    quantityControl.style.display = 'flex';
                    quantityControl.querySelector('.quantity').textContent = AppState.cart[id].quantity;
                }, 100);
            } else {
                addBtn.style.display = 'flex';
                quantityControl.style.display = 'none';
            }
        });
    }

    function updateMainButton() {
        const totalItems = Object.values(AppState.cart).reduce((sum, item) => sum + item.quantity, 0);

        if (totalItems > 0) {
            const buttonText = AppState.isFormVisible ? 'Надіслати замовлення' : `Переглянути кошик (${totalItems})`;
            AppState.tg.MainButton.setText(buttonText);
            AppState.tg.MainButton.setParams({
                color: '#D4935A',
                has_shine_effect: true,
                text_color: '#FFFFFF'
            });
            AppState.tg.MainButton.show();
        } else {
            AppState.tg.MainButton.hide();
            if (AppState.isFormVisible) closeOrderForm();
        }
    }

    function updateUI() {
        renderProducts();
        updateCartControls();

        const totalItems = Object.values(AppState.cart).reduce((sum, item) => sum + item.quantity, 0);
        elements.cartCount.textContent = totalItems;
        elements.cartCount.classList.toggle('hidden', totalItems === 0);
        
        if(AppState.tg) {
            updateMainButton();
        }
    }

    function showProductDetailsModal(title, description) {
        elements.modalTitle.textContent = title;
        elements.modalBody.innerHTML = description.replace(/\n/g, '<br><br>');
        elements.modal.classList.add('visible');
        AppState.tg?.BackButton.show();
    }

    function closeProductDetailsModal() {
        elements.modal.classList.remove('visible');
        // Приховуємо кнопку "Назад" ТГ, тільки якщо не відкрита форма замовлення
        if (!AppState.isFormVisible) {
            AppState.tg?.BackButton.hide();
        }
    }

    // --- ОБРОБНИКИ ПОДІЙ ---
    // productHandler.js
    function handleProductClick(e) {
        const card = e.target.closest('.product-card');
        if (!card) return;

        const productId = card.dataset.id;
        
        if (e.target.closest('.add-to-cart-btn')) {
            updateCart(productId, 'add');
        } else if (e.target.closest('.quantity-btn')) {
            const action = e.target.closest('.quantity-btn').dataset.action;
            updateCart(productId, action);
        } else if (e.target.closest('.details-btn')) {
            const detailsBtn = e.target.closest('.details-btn');
            const title = detailsBtn.dataset.title;
            const description = detailsBtn.dataset.description;
            showProductDetailsModal(title, description);
        }
    }
    
    // Promo
    function closePromo() {
        elements.promoSection.classList.add("promo-hide");
        setTimeout(() => elements.promoSection.style.display = "none", 400);
    }
    
    function initEventListeners() {
        // Cart & Order Form
        elements.cartBadge.addEventListener('click', () => {
            if (Object.keys(AppState.cart).length > 0) openOrderForm();
        });
        elements.changeOrderBtn?.addEventListener('click', closeOrderForm);
        elements.orderFormCloseBtn?.addEventListener('click', closeOrderForm);

        // Search
        elements.searchInput.addEventListener('input', () => updateUI());

        // Products
        elements.productList.addEventListener('click', handleProductClick);

        // Delivery Options
        elements.deliveryOptions.forEach(option => {
            option.addEventListener('change', () => {
                renderOrderSummary();
                toggleAddressField();
            });
        });

        // Modal Handlers
        elements.modalCloseBtn.addEventListener('click', closeProductDetailsModal);
        elements.modal.addEventListener('click', (e) => {
            if (e.target === elements.modal) {
                closeProductDetailsModal();
            }
        });

        // Promo Close
        elements.promoCloseBtn.addEventListener('click', closePromo);

        // Telegram WebApp Handlers
        if (AppState.tg) {
            AppState.tg.onEvent('backButtonClicked', () => {
                if (elements.modal.classList.contains('visible')) {
                    closeProductDetailsModal();
                } else if (AppState.isFormVisible) {
                    closeOrderForm();
                }
            });
            AppState.tg.onEvent('mainButtonClicked', () => {
                if (!AppState.isFormVisible) {
                    openOrderForm();
                } else {
                    submitOrder();
                }
            });
        }
    }

    // --- ІНІЦІАЛІЗАЦІЯ ---
    function initApp() {
        console.log('🚀 Initializing Family Cheese app...');
        initializeTelegramWebApp();
        initEventListeners();
        fetchUserData();
        
        loadProducts().then(() => {
            updateUI();
            console.log('✅ App initialized successfully');
        });
    }

    document.addEventListener('DOMContentLoaded', initApp);

</script>
</body>
</html>
